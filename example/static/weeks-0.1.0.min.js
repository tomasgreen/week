(function(){"use strict";function t(t,e,a,i){var s,n;e||(e={}),-1!==t.indexOf(".")&&(n=t.split("."),t=n[0],n.shift(),e["class"]=n.join(" ")),-1!==t.indexOf("#")&&(n=t.split("#"),t=n[0],e.id=n[1]),s=document.createElement(t);for(var l in e)s.setAttribute(l,e[l]);return a&&a.appendChild(s),i&&(s.innerHTML=i),s}function e(t,e){!t||0===t.length&&t!=window||(t.length?Array.prototype.forEach.call(t,function(t,a){e(t)}):e(t))}function a(t,e,a,n){i(t,e,function(i){a(i),s(t,e,a)},n)}function i(t,a,i,s){e(t,function(t){var e=a.split(" ");for(var n in e)t.addEventListener(e[n],i,s)})}function s(t,a,i){e(t,function(t){var e=a.split(" ");for(var s in e)t.removeEventListener(e[s],i)})}function n(t){void 0===t&&(t={});var e={};for(var a in p)e[a]=void 0!==t[a]?t[a]:p[a];return e}function l(t,e,i,s){i&&a(t,r,i),a(t,u,function(a){h(t,e),s&&s(a)}),o(t,e)}function o(t,a){e(t,function(t){if(t.classList){var e=a.split(" ");for(var i in e)t.classList.add(e[i])}else t.className+=" "+a})}function h(t,a){e(t,function(t){if(t.classList){var e=a.split(" ");for(var i in e)t.classList.remove(e[i])}else t.className=t.className.replace(new RegExp("(^|\\b)"+a.split(" ").join("|")+"(\\b|$)","gi")," ")})}var u="webkitAnimationEnd mozAnimationEnd msAnimationEnd oAnimationEnd animationend",r="webkitAnimationStart mozAnimationStart msAnimationStart oAnimationStart animationstart";Date.prototype.getWeek=function(){var t=new Date(this);t.setHours(0,0,0),t.setDate(t.getDate()+4-(t.getDay()||7));var e=new Date(t.getFullYear(),0,1);return Math.ceil(((t-e)/864e5+1)/7)},Date.prototype.format=function(){var t=this.getFullYear()+"-";return t+=(this.getMonth()<9?"0"+(this.getMonth()+1):this.getMonth()+1)+"-",t+=this.getDate()<9?"0"+this.getDate():this.getDate()},Date.prototype.setWeek=function(t,e){void 0===e&&(e=this.getFullYear());var a=new Date(e,0,1+7*(t-1)),i=a.getDay(),s=a;s.setDate(4>=i?a.getDate()-a.getDay()+1:a.getDate()+8-a.getDay()),this.setFullYear(s.getFullYear()),this.setMonth(s.getMonth()),this.setDate(s.getDate())};var p={date:null},d=function(e,a){this.opt=n(a),this.container=e,this.contentEl=t("div.week-content",null,this.container),this.yearEl=t("input.week-year",{type:"text",placeholder:"YYYY",maxlength:"4"},this.contentEl),this.weekEl=t("input.week-week",{type:"text",maxlength:"2"},this.contentEl),this.dateEl=t("input.week-date",{type:"text",placeholder:"YYYY-MM-DD",maxlength:"10"},this.contentEl),this.infoEl=t("div.week-info",null,this.contentEl),this.opt.date||(this.opt.date=new Date,this.autoupdate()),this.resetAll(this.opt.date),i([document.documentElement],"keyup",this.containerElKeyUp.bind(this)),i(this.dateEl,"keyup",this.dateElKeyUp.bind(this),!1),i(this.weekEl,"keyup",this.weekElKeyUp.bind(this),!1),i(this.yearEl,"keyup",this.yearElKeyUp.bind(this),!1)};d.prototype.containerElKeyUp=function(t){t.srcElement==document.body&&(70==t.keyCode||72==t.keyCode||(82==t.keyCode?this.resetAll(new Date):65==t.keyCode&&(null===this.interval&&this.resetAll(new Date),this.autoupdate(null===this.interval))))},d.prototype.weekElKeyUp=function(t){this.weekEl.value>53||this.weekEl.value<1||this.weekEl.lastValue==this.weekEl.value||(isNaN(this.opt.date)&&(this.opt.date=new Date),this.weekEl.lastValue=this.weekEl.value,this.opt.date.setWeek(parseInt(this.weekEl.value,10),this.yearEl.value),this.updateDate(),this.setSpan(),this.autoupdate(!1))},d.prototype.yearElKeyUp=function(t){this.yearEl.value.length<4||this.yearEl.lastValue==this.yearEl.value||(this.opt.date.setFullYear(this.yearEl.value),this.yearEl.lastValue=this.yearEl.value,this.updateWeek(),this.updateDate(),this.setSpan(),this.autoupdate(!1))},d.prototype.dateElKeyUp=function(t){this.dateEl.value.length<10||this.dateEl.lastValue==this.dateEl.value||(this.dateEl.lastValue=this.dateEl.value,this.opt.date=new Date(this.dateEl.value),this.updateYear(),this.updateWeek(),this.setSpan(),this.autoupdate(!1))},d.prototype.autoupdate=function(t){void 0===t&&(t=!0),this.interval&&(clearInterval(this.interval),this.interval=null,console.log("autoupdate off")),t&&(this.interval=setInterval(this.tick.bind(this),1e3),console.log("autoupdate on"))},d.prototype.tick=function(){var t=new Date;this.opt.date.format()!=t.format()&&this.resetAll(t)},d.prototype.setSpan=function(){if(!isNaN(this.opt.date)){var t=new Date(this.opt.date);t.setWeek(this.opt.date.getWeek(),this.yearEl.value);var e=new Date(t);e.setDate(e.getDate()+6);var a=t.format()+" â†’ "+e.format();this.infoEl.textContent!=a&&(this.infoEl.textContent=a,l(this.infoEl,"week-bounce-in"))}},d.prototype.resetAll=function(t){t&&(this.opt.date=t),this.yearEl.value=this.yearEl.lastValue=this.opt.date.getFullYear(),this.weekEl.value=this.weekEl.lastValue=this.opt.date.getWeek(),this.dateEl.value=this.dateEl.lastValue=this.opt.date.format(),this.setSpan(),l(this.weekEl,"week-bounce-in"),l(this.yearEl,"week-bounce-in"),l(this.dateEl,"week-bounce-in")},d.prototype.updateDate=function(){isNaN(this.opt.date)||this.dateEl.lastValue==this.opt.date.format()||(this.dateEl.value=this.dateEl.lastValue=isNaN(this.opt.date)?"?":this.opt.date.format(),l(this.dateEl,"week-bounce-in"))},d.prototype.updateWeek=function(){isNaN(this.opt.date)||this.weekEl.lastValue==this.opt.date.getWeek()||(this.weekEl.value=this.weekEl.lastValue=isNaN(this.opt.date)?"?":this.opt.date.getWeek(),l(this.weekEl,"week-bounce-in"))},d.prototype.updateYear=function(){isNaN(this.opt.date)||this.yearEl.lastValue==this.opt.date.getFullYear()||(this.yearEl.value=this.yearEl.lastValue=this.opt.date.getFullYear(),l(this.yearEl,"week-bounce-in"))},this.Weeks=function(t,e){var a=new d(t,e);return a},this.Weeks.globals=p}).call(this);