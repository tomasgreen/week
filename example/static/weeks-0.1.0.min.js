(function(){"use strict";function t(t,e,a,i){var n,s;e||(e={}),-1!==t.indexOf(".")&&(s=t.split("."),t=s[0],s.shift(),e["class"]=s.join(" ")),-1!==t.indexOf("#")&&(s=t.split("#"),t=s[0],e.id=s[1]),n=document.createElement(t);for(var l in e)n.setAttribute(l,e[l]);return a&&a.appendChild(n),i&&(n.innerHTML=i),n}function e(t,e){!t||0===t.length&&t!=window||(t.length?Array.prototype.forEach.call(t,function(t,a){e(t)}):e(t))}function a(t,e,a,s){i(t,e,function(i){a(i),n(t,e,a)},s)}function i(t,a,i,n){e(t,function(t){var e=a.split(" ");for(var s in e)t.addEventListener(e[s],i,n)})}function n(t,a,i){e(t,function(t){var e=a.split(" ");for(var n in e)t.removeEventListener(e[n],i)})}function s(t){void 0===t&&(t={});var e={};for(var a in E)e[a]=void 0!==t[a]?t[a]:E[a];return e}function l(t,e,i,n){i&&a(t,c,i),a(t,d,function(a){h(t,e),n&&n(a)}),o(t,e)}function o(t,a){e(t,function(t){if(t.classList){var e=a.split(" ");for(var i in e)t.classList.add(e[i])}else t.className+=" "+a})}function h(t,a){e(t,function(t){if(t.classList){var e=a.split(" ");for(var i in e)t.classList.remove(e[i])}else t.className=t.className.replace(new RegExp("(^|\\b)"+a.split(" ").join("|")+"(\\b|$)","gi")," ")})}function u(t){var e=new Date(t);e.setHours(0,0,0),e.setDate(e.getDate()+4-(e.getDay()||7));var a=new Date(e.getFullYear(),0,1);return Math.ceil(((e-a)/864e5+1)/7)}function r(t){var e=t.getFullYear()+"-";return e+=(t.getMonth()<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-",e+=t.getDate()<10?"0"+t.getDate():t.getDate()}function p(t,e,a){void 0===a&&(a=t.getFullYear());var i=new Date(a,0,1+7*(e-1)),n=i.getDay(),s=i;s.setDate(4>=n?i.getDate()-i.getDay()+1:i.getDate()+8-i.getDay()),t.setFullYear(s.getFullYear()),t.setMonth(s.getMonth()),t.setDate(s.getDate())}var d="webkitAnimationEnd mozAnimationEnd msAnimationEnd oAnimationEnd animationend",c="webkitAnimationStart mozAnimationStart msAnimationStart oAnimationStart animationstart",E={date:null},v=function(e,a){this.opt=s(a),this.container=e,this.contentEl=t("div.week-content",null,this.container),this.yearEl=t("input.week-year",{type:"text",placeholder:"YYYY",maxlength:"4"},this.contentEl),this.weekEl=t("input.week-week",{type:"text",maxlength:"2"},this.contentEl),this.dateEl=t("input.week-date",{type:"text",placeholder:"YYYY-MM-DD",maxlength:"10"},this.contentEl),this.infoEl=t("div.week-info",null,this.contentEl),this.opt.date||(this.opt.date=new Date,this.autoupdate()),this.resetAll(this.opt.date),i([document.documentElement],"keyup",this.containerElKeyUp.bind(this)),i(this.dateEl,"keyup",this.dateElKeyUp.bind(this),!1),i(this.weekEl,"keyup",this.weekElKeyUp.bind(this),!1),i(this.yearEl,"keyup",this.yearElKeyUp.bind(this),!1)};v.prototype.containerElKeyUp=function(t){t.srcElement==document.body&&(70==t.keyCode||72==t.keyCode||(82==t.keyCode?this.resetAll(new Date):65==t.keyCode&&(null===this.interval&&this.resetAll(new Date),this.autoupdate(null===this.interval))))},v.prototype.weekElKeyUp=function(t){this.weekEl.value>53||this.weekEl.value<1||this.weekEl.lastValue==this.weekEl.value||(isNaN(this.opt.date)&&(this.opt.date=new Date),this.weekEl.lastValue=this.weekEl.value,p(this.opt.date,parseInt(this.weekEl.value,10),this.yearEl.value),this.updateDate(),this.setSpan(),this.autoupdate(!1))},v.prototype.yearElKeyUp=function(t){this.yearEl.value.length<4||this.yearEl.lastValue==this.yearEl.value||(this.opt.date.setFullYear(this.yearEl.value),this.yearEl.lastValue=this.yearEl.value,this.updateWeek(),this.updateDate(),this.setSpan(),this.autoupdate(!1))},v.prototype.dateElKeyUp=function(t){this.dateEl.value.length<10||this.dateEl.lastValue==this.dateEl.value||(this.dateEl.lastValue=this.dateEl.value,this.opt.date=new Date(this.dateEl.value),this.updateYear(),this.updateWeek(),this.setSpan(),this.autoupdate(!1))},v.prototype.autoupdate=function(t){void 0===t&&(t=!0),this.interval&&(clearInterval(this.interval),this.interval=null,console.log("autoupdate off")),t&&(this.interval=setInterval(this.tick.bind(this),1e3),console.log("autoupdate on"))},v.prototype.tick=function(){var t=new Date;r(this.opt.date)!=r(t)&&this.resetAll(t)},v.prototype.setSpan=function(){if(!isNaN(this.opt.date)){var t=new Date(this.opt.date);p(t,u(this.opt.date),this.yearEl.value);var e=new Date(t);e.setDate(e.getDate()+6);var a=r(t)+" â†’ "+r(e);this.infoEl.textContent!=a&&(this.infoEl.textContent=a,l(this.infoEl,"week-bounce-in"))}},v.prototype.resetAll=function(t){t&&(this.opt.date=t),this.yearEl.value=this.yearEl.lastValue=this.opt.date.getFullYear(),this.weekEl.value=this.weekEl.lastValue=u(this.opt.date),this.dateEl.value=this.dateEl.lastValue=r(this.opt.date),this.setSpan(),l(this.weekEl,"week-bounce-in"),l(this.yearEl,"week-bounce-in"),l(this.dateEl,"week-bounce-in")},v.prototype.updateDate=function(){isNaN(this.opt.date)||this.dateEl.lastValue==r(this.opt.date)||(this.dateEl.value=this.dateEl.lastValue=isNaN(this.opt.date)?"?":r(this.opt.date),l(this.dateEl,"week-bounce-in"))},v.prototype.updateWeek=function(){isNaN(this.opt.date)||this.weekEl.lastValue==u(this.opt.date)||(this.weekEl.value=this.weekEl.lastValue=isNaN(this.opt.date)?"?":u(this.opt.date),l(this.weekEl,"week-bounce-in"))},v.prototype.updateYear=function(){isNaN(this.opt.date)||this.yearEl.lastValue==this.opt.date.getFullYear()||(this.yearEl.value=this.yearEl.lastValue=this.opt.date.getFullYear(),l(this.yearEl,"week-bounce-in"))},this.Weeks=function(t,e){var a=new v(t,e);return a},this.Weeks.globals=E}).call(this);